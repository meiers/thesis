DNA sequencing refers to the process of deciphering the order of the four bases
(adenine, cytosine, guanine, and thymine, abbreviated by A, C, G, and T) that
constitute a DNA molecule. In the 1990s, sequencing the DNA of humans was a
decade-long, multi-million dollar effort but it led to the successful production
of a reference genome of humans and many other organisms
\citep{Lander2001,Venter2001}. Today, thanks to technological improvements,
DNA sequencing has become a standard technique applied on a daily basis in
genomics research. The advance of sequencing technologies has truly
revolutionized genetic research and brought unforeseen capabilities also to
studies of structural variation. In fact, these capabilities have not yet
reached their limit (as described in \cref{sv_detection}) and ongoing
development of new technologies and protocols is continuously pushing the
boundaries of what is possible. Since DNA sequencing takes such a prominent
position in my research---virtually every experiment in this thesis includes
sequencing---the major techniques shall be introduced here.




\subsection{Massively parallel sequencing}
\label{sec:mps}

The foundation of modern DNA sequencing technologies was laid in 1977 by Sanger
and his ``chain termination'' technique \citep{Sanger1977}. Despite not being
the first DNA sequencing method, the chain termination method brought
unprecedented ease of use and accuracy \citep{Heather2016}. It is based on DNA
polymer extension via DNA-dependent DNA polymerase (i.e. replication) and the
incorporation of dideoxynucleotides, which stop polymerization. With subsequent
electrophoresis, partially replicated DNA fragments can be ordered by length and
nucleotides identified based on radioactive or fluorescent labels.
Sanger sequencing was instrumental in the Human Genome Project and owing to the
accuracy and length (around 1~kb) of sequenced fragments, it is still used
today for validation purposes. It sequences single DNA fragments, though, and
is thus laborious to apply in a larger scale.

The throughput could be dramatically increased with the advance of \acf{mps},
which is also referred to as short-read sequencing,
2\textsuperscript{nd}-generation sequencing, or high-throughput sequencing.
Different commercial techniques were brought forward in the first decade of this
millennium, including Pyrosequencing by 454 Life Sciences, Sequencing by
Oligonucleotide Ligation and Detection (SOLiD) by Applied Biosystems,
Nanoball Sequencing by Complete Genomics, Helicos Single Molecule Fluorescent
Sequencing by Helicos BioSciences, and the Reversible Terminator Chemistry by
Solexa \citep{wikiDNAseq2018}. Today, the market for \mps technologies is vastly
dominated by Illumina, who acquired Solexa and their technology in 2007. Here,
the core principles of Illumina DNA sequencing shall be described representative
for MPS in general.

Like the Sanger technique, Solexa/Illumina’s approach relies on the concept of
sequencing by synthesis, i.e. by replication through a DNA polymerase. It in
fact also utilizes the incorporation of fluorescently labeled dideoxynucleotides,
which initially terminates the polymerization. A major novelty, though, is that
the fluorescent label can be removed and the $3^\prime$ hydroxyl group of the
dideoxynucleotide restored chemically. This technique is widely known as
reversible terminator chemistry \citep{Turcatti2008}. DNA is then replicated
step by step, in each of which the incorporated nucleotides are detected using
fluorescent imaging. This concept of cyclic amplification followed by
fluorescent detection is shared by multiple of the aforementioned techniques,
which use slighly different molecular mechanisms \citep{Shendure2008}.

Another key concept of \mps technologies is a step of clonal amplification of
DNA fragments in order to enhance the fluorescent signal detection. DNA
fragments are initially ligated to adapter sequences and then, in case of
Solexa/Illumina, immobilized on the flow cell and amplified via
\explain{\acf{pcr}}{Did you know that \acs{pcr} was invented only after Sanger
    sequencing, in 1983? See \cite{Mullis1990} for a brief history.}
    \citep{Mullis1990}.
The aspect of parallelism comes into play when many (up to millions of) local
clusters, each with a clonally amplified DNA fragment, are observed
simultaneously during nucleotide incorporation. This again was driven by
technological advances in high-resolution cameras, notably based on
charge-coupled devices \citep{Barbe1975,Shendure2008}.

\figurepagewidth[t]{reads.pdf}{reads}{MPS sequencing reads}{Sequencing reads
    from \mps are typically short (for example 100~bp), are sequenced from
    their $5^\prime$ ends and can be single-ended or paired-end. In
    paired-end or mate pair libraries, the lengths of the original DNA fragment
    (which can be estimated after read mapping) is called insert size and
    usually much larger in mate pair experiments than paired-end experiments.}

In contrast to Sanger sequencing, which targets a single locus, \mps can be
applied to perform \emph{\acf{wgs}}. During \wgs, DNA is highly fragmented prior
to construct a sequqncing \emph{library}, which is then sequenced via \mps to
yield a large set of \emph{sequencing reads} from
all over the genome. Due to the random fragmentation this approach is also
commonly known as shotgun-sequencing \citep{Weber1997}. In a typical
\emph{re-sequencing} experiment, where a species with available reference genome
is sequenced, these reads are then mapped to the reference for further analysis
such as, for example, variant detection. Apart from \wgs, a large number of
other sequencing protocols exist that utilize \mps to study different molecular
characteristics\footnote{see Pachter2018 for a list of such protocols}.
A prominent example is RNA-seq \citep{Morin2008,Wang2009},
which make the mRNA present in cells available to sequencing by
reverse-transcription it into cDNA---we applied this in \cref{sec:balancer}.
\Cref{sec:ccc,sec:strandseq} cover two other protocols based on MPS that are
of particular interest in this work.

Modern sequencing machines offer the possibility to sequence a DNA fragment
from both ends. In case of Illumina/Solexa, this is achieved by a special step
of bridge amplification that anneals the free end of all fragments in a clonal
cluster to the surface and then frees the initially attached ends. Afterwards,
sequencing continues in opposite direction to capture the other end of the
DNA fragments. This approach is called \emph{paired-end} sequencing or
paired-end tag sequencing and was used early on to study structural variants
\citep{Campbell2008} (see also \cref{sec:sv_detection_ngs}). Paired-end reads
typically allow the sequencing of fragments of up to 500~bp – larger fragments
(typically around 3~kb, but up to 10~kb) can be achieved by creating
\emph{mate pair} libraries (a.k.a jumping libraries). In the approach of mate
pair sequencing, a longer DNA fragment is first circularized before the
connection of both ends is sequenced either single-ended or in paired-end mode
\citep{Korbel2007}. In contrast to paired-end reads, which are sequenced from
their $5^\prime$ ends towards one another and accordingly align in convergent
orientation to the reference genome, mate pairs align in divergent orientation
(see \cref{fig:reads}). The size of the sequenced fragment is called
\emph{insert size} and the number of sequenced bases \emph{read length}.








\subsection{Emerging long read sequencing technologies}
\label{sec:long_read_seq}

Over the last years, new sequencing technologies have been developed which are
commonly referred to ``3rd-generation sequencing'' in the community. These
technologies are fundamentally different to \mps technologies as they avoid
clonal expansion of DNA fragments, but sequence single molecules instead.
Although single molecule sequencing had been feasible already earlier
\citep{Braslavsky2003}, later commercialized by Helicos BioSciences,
third-generation sequencing is commonly associated only with the techniques of
\acf{pacbio} and \acf{ont}. In contrast to the Helicos platform, these
techniques achieve significantly longer read lengths (of up to more than 100~kb)
at usually decreased accuracy. Unlike Sanger's technology, they still sequence
many molecules in parallel.

\figuretextwidth{third_gen_seq_Heather2016.png}{third_gen}{Concepts of
    \texorpdfstring{\acs{pacbio}}{PacBio} and \texorpdfstring{\acs{ont}}{ONT}
    sequencing}{
    \textbf{A:} DNA polymerase inside a zero-mode waveguide processes a DNA
    molecule. The fluorescently labeled nucleotides are preferably illuminated
    at the bottom of the well, distinguishing their signal from the pool of
    nucleotides in the solution.
    \textbf{B:} Nanopore sequencing by passaging of a single-stranded DNA
    polymer through a pore in a non-conductive layer. Movement of the DNA
    molecule is facilitated by a voltage across the layer and decelerated by a
    processive enzyme (upper ellipse), e.g. a helicase that unwinds the double
    stranded DNA.
    Figure taken from \citetitle{Heather2016} \citep{Heather2016} licensed under
    \acl{ccby4}.}

The technology of \acl{pacbio} relies on the concept of sequencing by synthesis using
fluorescently labeled deoxynucleotides. Unlike with Illumina, the sequencing
occurs in real time on single molecules and was hence termed
\emph{Single-Molecule Real-Time sequencing (SMRT)} \citep{Eid2009}. Fluorescent
image detection occurs not in cycles, but continuously (creating a \emph{movie}).
Besides deciphering the order of nucleotides, this principle also measures
kinetics of the polymerase, allowing the detection of modified bases such as
methylated cytosine \citep{Flusberg2010}. The major challenge in SMRT sequencing
is the detection of the fluorescence signal from a single nucleotide upon
ligation. To this end, researchers had engineered microplates with so-called
zero-mode wave guides \citep{Uemura2010}. The laser for excitation of
fluorophores only illuminates the bottom of these nanowells, in each of which a
polymerase is deposited so that nucleotides can be detected during incorporation
against a background of fluorophores outside the well \citep{Heather2016} (see
\cref{fig:third_gen}a). Single-molecule base detection is still noisier than
detection in clonally amplified sequences, leading to reported per-base-error
rates of 11-15\% \citep{Rhoads2015}. To improve accuracy, \pacbio researchers
promoted a technique called \emph{circular consensus sequence (CCS)}
\citep{Travers2010}. Here, a double-stranded DNA fragment ligates to circular
adapters on both ends to form a circular DNA backbone, which still preserving
its DNA double-stranded structure. The polymerase can then pass this ring of DNA
repeatedly, effectively sequencing the same fragment multiple times. This long
read is computationally divided into sub-reads and a consensus is formed with
reported accuracies of up to more than 99\% \citep{Rhoads2015}.

\Acl{ont} utilize a fundamentally different approach to sequence single
molecules. Driven by electrophoresis, a single-stranded DNA passes through a
tiny pore that can detect changes in the ionic current specific to the type of
nucleotide passing through. The development of this technique spanned three
decades and is based on findings from multiple labs, as \cite{Deamer2016}
nicely portrayed. One major step towards the current technology was to find an
appropriate pore that is just wide enough for a single-stranded DNA molecule to
pass through: Initially \textit{α-hemolysin} channels from
\textit{Staphylococcus aureus} had been used, which were later replaced by a
genetically modified version of \textit{MspA}, a porin from
\textit{Mycobacterium smegmatis} that allowed a much better signal-to-noise
ratio \citep{Butler2008}. A second crucial step was to decelerate the passage of
each single nucleotide through the pore in order to allow accurate measurements
of currents. While DNA polymers would pass a pore at a rate of $10^{-13}$ sec
per nucleotide even for the smallest voltages, researchers had the idea to place
processive enzymes in front of the pore that slightly pause passage with each
nucleotide \citep{Deamer2016}. \Ac{ont} offered the first commercially availabe
nanopore sequeqncing devices, named MinION, in an early access program from 2014.
They utilize an ATP-dependent helicase enzyme that unwinds double-stranded DNA
before passaging the pores, with detection happening simultaneously at up to
512 pores \citep{Jain2015}. A hairpin adapter is ligated to DNA fragments, so
that after a single strand has passed the pore the complementary strand
(linked covalently via the hairpin adapter) follows. This sequences the same
fragment twice and is utilized to improve sequencing quality. The corrected reads
are called \emph{2D reads} and were reported to have an improved error rate of
15\% \citep{Jain2015}. Through the MinION early acces program our laboratory
gained access to MinION devices, so that we could apply the technique in my
research project describe in \cref{sec:complex_invs}.






\subsection{Chromatin conformation capture sequencing}
\label{sec:ccc}

Studies of the three-dimensional structure of in vivo chromatin have for a long
time been limited to imaging-based approaches. \cite{Dekker2002}, however,
proposed a new technique named \emph{chromatin conformation capture (3C)} that
probes the three-dimensional distance of loci using genomics methods. The basic
idea is to crosslink DNA with itself in regions that are in close spatial
proximity. The results of such experiments give insight into the contact
frequency between two loci relative to other loci, which can be interpreted as
an average three-dimensional distance between the loci observed across many
nuclei. The original 3C protocol relies on targeted \pcr amplification and is
capable of testing the interaction between exactly two loci. However, multiple
protocols based on 3C have recently been shown to increase the level of
parallelism, including 4C \citep{Zhao2006,Simonis2006} and 5C \citep{Dostie2006}.
Eventually, the combination of chromatin conformation capture and \mps resulted
in \acf{hic} \citep{Lieberman-Aiden2009}. The core principle of \hic, as shown
in \cref{fig:ccc}, involves cross-linking and digestion of DNA and then
submitting cross-linked loci to paired-end \mps. After filtering of data (e.g.
removing fragments ligated to themselves) both reads of a pair represent two
loci that were in close three-dimensional proximity within the nucleus.
Principally, the unbiased contact frequency of all loci against all other loci
can be measured in this way. In practice, the resolution of these two-dimensional
contact map strongly depends on sequencing coverage. For example, to achieve
1~kb resolution, \cite{Rao2014} utilized 4.9 billion pairwise contacts in a
human cell line.

\figuretextwidth{chrom_conf_cap_Li2014_CC.jpg}{ccc}{Chromatin conformation
    capture technologies}{
    Chromatin conformation capture relies on cross-linking of DNA, enzymatic
    digestion and subsequent ligation of cross-linked loci. In the 3C-protocol,
    targeted interactions can be analyzed via \pcr. The \hic protocol enriches
    for cross-linked fragments based on biotin labels before these fragments
    are paired-end sequneced. Figure modified from \citetitle{Li2014}
    \citep{Li2014}  licensed under \acl{ccby4}.}

\hic was designed and used to study chromatin conformation and specific
three-dimensional features such as DNA loops forming between enhancers and
promoters. It further revealed previously unknown structural features of the
genome, which are discussed in more detail in \cref{sec:balancer_hic_svs}.
However, the characteristics of \hic contact maps predestinate them for at least
two additional use cases: Intra-chromosomal interactions are more frequent than
inter-chromosomal interactions, which is in concordance with the theory of
chromosomal territories \citep{Meaburn2007}. Thus, \hic data can by utilized to
cluster genomic loci by chromosome, which is especially relevant for \textit{de
novo} assembly \citep{Burton2013}. Another observation is that the contact
frequency between loci typically decays quickly with increasing genomic
distance, meaning that the highest signal is detected between loci that are also
close in linear genomic proximity. Because of that, larger genomic
rearrangements become prominent in contact maps---I utilized this feature of
\hic maps to characterize genomic rearrangements in \cref{sec:balancer}.





\subsection{Strand-seq}
\label{sec:strandseq}

Strand-seq is a single-cell DNA sequencing protocol that preserves the identity
of homologues by sequencing only the template strand of each chromosome
\citep{Falconer2012,Sanders2017}. The readout are sequencing reads, obtained via
\mps (e.g. on an Illumina platform) in either paired-end or single-ended mode,
which all map in the same orientation (plus strand or minus strand) to a
reference genome if they originate from the same homologue. In cells where
homologues are inherited on opposite strands, so-called Watson and Crick
strands, the original homologue for each sequence can be determined simply based
on its mapping orientation. Strand-seq can thus reliably phase (i.e. distinguish
haplotypes) chromosomes in their full length \citep{Porubsky2016}. Moreover,
given the consistent directionality of sequencing reads across a homologue,
Strand-seq allows to detect (large) inversions as sequencing reads flip
orientation once mapped to the non-inverted reference genome \citep{Sanders2016}.
Strand-seq was futher used to study sister chromatid exchange events
\citep{Falconer2012}. In \cref{sec:mosaicatcher}, I present a novel approach
that utilizes Strand-seq libraries across multiple single cells to detect mosaic
\acp{sv}.

\figuretextwidth{strand_seq.pdf}{strand_seq}{Strand-seq principle}{
    Diploid cells (here schematically represented only for a single pair of
    chromosomes) contain maternal (M) and paternal (P) homologous chromosomes,
    each of which is a double-stranded DNA molecule. Watson (W) and Crick (C)
    are highlighted in orange and green. After replication in the presence of
    BrdU instead of Thymidine (1), cells contain two sister chromatids of each
    homologous chromosome, each with a different strand labeled (dotted line).
    After cell division, photolytic nicking of BrdU sites and library
    preparation (2), only sequencing reads from the non-labeled strand remain.
    \textbf{Right side:} A daughter cell inherits the two homologues in one of
    four different constellations, i.e. both as W (top left), both as C (top
    right), or both as different strands (maternal W, bottom left, or paternal
    W, bottom right). After read mapping cells appear in WW, CC, or WC
    configuration (circles). Figure modified from \citetitle{Sanders2016}
    \citep{Sanders2016} licensed under \acl{ccby4}.}

Strand-seq requires actively replicating cells, which are grown for a single
round of replication in a $5$-Bromo-$2^\prime$-deoxyuridine (BrdU) medium.
The incorporation of this thymidine analog into the newly synthesized DNA strand
is the basis for obtaining stranded sequencing libraries, because after cell
division each daughter cell will have only one strand labeled with BrdU
(\cref{fig:strand_seq}). After cytokinesis, the DNA of a daughter cell is
enzymatically digested into fragments and ligated to sequencing adaptors. BrdU
containing fragments are then degraded via photolytic cleavage, so that
subsequently only non-BrdU containing fragments are amplified via \pcr.
Fragments from each single cell are tagged with cell-specific barcodes and are
finally sequenced simultaneously, typically 96 cells together in one Illumina
lane \citep{Sanders2017}.


